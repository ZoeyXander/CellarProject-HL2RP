if not SERVER then return end;yufu=yufu or{}function yufu.cp(a,b,c,d,e)a,b=tostring(a),tostring(b)MsgC(Color(195,195,195),'[yufu] [ ')MsgC(Color(c,d,e),a)MsgC(Color(195,195,195),' ] '..b..'\n')end;require('serversecure')if not serversecure then yufu.cp('WARNING','Cant detect ServerSecure library. Skipping it.',246,100,122)return else yufu.cp('INFO','Found ServerSecure library. Initialization.',153,170,233)end;yufu.ss=serversecure;yufu.ss.ply=yufu.ss.GetClientCount()or 0;yufu.ss.status=false;function ss_core()if not yufu.ss then yufu.cp('WARNING','ServerSecure started init without library. What the fuck?')return end;if yufu.ss.status==false then yufu.ss.EnableFileValidation(true)yufu.ss.EnablePacketValidation(true)yufu.ss.EnableInfoCache(true)yufu.ss.SetInfoCacheTime(60)yufu.ss.EnableQueryLimiter(true)yufu.ss.SetMaxQueriesWindow(30)yufu.ss.SetMaxQueriesPerSecond(1)yufu.ss.SetGlobalMaxQueriesPerSecond(40)yufu.ss.RefreshInfoCache()yufu.cp('INFO','ServerSecure is working now.',153,170,233)yufu.ss.status=true else yufu.cp('PLAYER','Updating cache.',153,170,233)yufu.ss.RefreshInfoCache()end end;hook.Add('PlayerInitialSpawn','yufu.ss.init',ss_core)concommand.Add('ss_help',function()yufu.cp('ServerSecure Library by danielga','\n\nServerSide only. Usage: yufu.ss.Function() or serversecure.Function().\n\n',153,170,233)yufu.cp('EnableFirewallWhitelist','(bool) -- enables firewall whitelist. Any client not in the whitelist doesnt see the server',153,170,233)yufu.cp('AddWhitelistIP','(ip_in_integer_format) -- add an IP to the whitelist',153,170,233)yufu.cp('RemoveWhitelistIP','(ip_in_integer_format) -- remove an IP from the whitelist',153,170,233)yufu.cp('ResetWhitelist','() -- flush the whitelist\n',153,170,233)yufu.cp('EnableFirewallBlacklist','(bool) -- enables firewall blacklist. Any client in the blacklist doesnt see the server.',153,170,233)yufu.cp('AddBlacklistIP','(ip_in_integer_format) -- add an IP to the blacklist',153,170,233)yufu.cp('RemoveBlacklistIP','(ip_in_integer_format) -- remove an IP from the blacklist',153,170,233)yufu.cp('ResetBlacklist','() -- flush the blacklist\n',153,170,233)yufu.cp('EnableFileValidation','(bool) -- validates files requrested by clients for download',153,170,233)yufu.cp('EnableThreadedSocket','(bool) -- receives packets from the game socket on another thread and analyzing it',153,170,233)yufu.cp('EnablePacketValidation','(bool) -- validates packets for correct type, size, content, etc',153,170,233)yufu.cp('EnableInfoCache','(bool) -- enable A2S_INFO response cache',153,170,233)yufu.cp('SetInfoCacheTime','(int) -- seconds for cache to live (default is 5 secs)',153,170,233)yufu.cp('EnableQueryLimiter','(bool) -- enable query limiter (similar to Source one but all handles on the same place)',153,170,233)yufu.cp('SetMaxQueriesWindow','(int) -- timespan over which to average query counts from IPs (defaults in 30 seconds)',153,170,233)yufu.cp('SetMaxQueriesPerSecond','(int) -- maximus queries per second from a single IP (default is 1 per second)',153,170,233)yufu.cp('SetGlobalMaxQueriesPerSecond','(int) -- maximum total queries per second (default is 60 per second)',153,170,233)yufu.cp('EnablePacketSampling','(bool) -- damn',153,170,233)yufu.cp('GetSamplePacket','() -- furry',153,170,233)yufu.cp('IPToString','(ip_in_integer_format) -- converting IP to String',153,170,233)yufu.cp('StringToIP','(string) -- converting String to IP',153,170,233)end)concommand.Add('ss_reload',function()yufu.cp('INFO','ServerSecure reloading.',153,170,233)yufu.ss.status=false;ss_core()end)

if not SERVER then return end;yufu=yufu or{}function yufu.cp(a,b,c,d,e)a,b=tostring(a),tostring(b)MsgC(Color(195,195,195),'[yufu] [ ')MsgC(Color(c,d,e),a)MsgC(Color(195,195,195),' ] '..b..'\n')end;require('serversecure')if not serversecure then yufu.cp('WARNING','Cant detect ServerSecure library. Skipping it.',246,100,122)return else yufu.cp('INFO','Found ServerSecure library. Initialization.',153,170,233)end;yufu.ss=serversecure;yufu.ss.ply=yufu.ss.GetClientCount()or 0;yufu.ss.status=false;function ss_core()if not yufu.ss then yufu.cp('WARNING','ServerSecure started init without library. What the fuck?')return end;if yufu.ss.status==false then yufu.ss.EnableFileValidation(true)yufu.ss.EnablePacketValidation(true)yufu.ss.EnableInfoCache(true)yufu.ss.SetInfoCacheTime(60)yufu.ss.EnableQueryLimiter(true)yufu.ss.SetMaxQueriesWindow(30)yufu.ss.SetMaxQueriesPerSecond(1)yufu.ss.SetGlobalMaxQueriesPerSecond(40)yufu.ss.RefreshInfoCache()yufu.cp('INFO','ServerSecure is working now.',153,170,233)yufu.ss.status=true else yufu.cp('PLAYER','Updating cache.',153,170,233)yufu.ss.RefreshInfoCache()end end;hook.Add('PlayerInitialSpawn','yufu.ss.init',ss_core)concommand.Add('ss_help',function()yufu.cp('ServerSecure Library by danielga','\n\nServerSide only. Usage: yufu.ss.Function() or serversecure.Function().\n\n',153,170,233)yufu.cp('EnableFirewallWhitelist','(bool) -- enables firewall whitelist. Any client not in the whitelist doesnt see the server',153,170,233)yufu.cp('AddWhitelistIP','(ip_in_integer_format) -- add an IP to the whitelist',153,170,233)yufu.cp('RemoveWhitelistIP','(ip_in_integer_format) -- remove an IP from the whitelist',153,170,233)yufu.cp('ResetWhitelist','() -- flush the whitelist\n',153,170,233)yufu.cp('EnableFirewallBlacklist','(bool) -- enables firewall blacklist. Any client in the blacklist doesnt see the server.',153,170,233)yufu.cp('AddBlacklistIP','(ip_in_integer_format) -- add an IP to the blacklist',153,170,233)yufu.cp('RemoveBlacklistIP','(ip_in_integer_format) -- remove an IP from the blacklist',153,170,233)yufu.cp('ResetBlacklist','() -- flush the blacklist\n',153,170,233)yufu.cp('EnableFileValidation','(bool) -- validates files requrested by clients for download',153,170,233)yufu.cp('EnableThreadedSocket','(bool) -- receives packets from the game socket on another thread and analyzing it',153,170,233)yufu.cp('EnablePacketValidation','(bool) -- validates packets for correct type, size, content, etc',153,170,233)yufu.cp('EnableInfoCache','(bool) -- enable A2S_INFO response cache',153,170,233)yufu.cp('SetInfoCacheTime','(int) -- seconds for cache to live (default is 5 secs)',153,170,233)yufu.cp('EnableQueryLimiter','(bool) -- enable query limiter (similar to Source one but all handles on the same place)',153,170,233)yufu.cp('SetMaxQueriesWindow','(int) -- timespan over which to average query counts from IPs (defaults in 30 seconds)',153,170,233)yufu.cp('SetMaxQueriesPerSecond','(int) -- maximus queries per second from a single IP (default is 1 per second)',153,170,233)yufu.cp('SetGlobalMaxQueriesPerSecond','(int) -- maximum total queries per second (default is 60 per second)',153,170,233)yufu.cp('EnablePacketSampling','(bool) -- damn',153,170,233)yufu.cp('GetSamplePacket','() -- furry',153,170,233)yufu.cp('IPToString','(ip_in_integer_format) -- converting IP to String',153,170,233)yufu.cp('StringToIP','(string) -- converting String to IP',153,170,233)end)concommand.Add('ss_reload',function()yufu.cp('INFO','ServerSecure reloading.',153,170,233)yufu.ss.status=false;ss_core()end)
